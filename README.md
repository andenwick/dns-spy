# DNS Spy

Network security tool for real-time DNS traffic analysis and threat detection.

## Features

- **Real-time DNS capture** - Monitor all DNS queries on your network
- **DGA detection** - Flag domains generated by malware algorithms
- **Exfiltration detection** - Identify data being tunneled through DNS
- **DNS tunneling detection** - Catch tools like dnscat, iodine, dns2tcp
- **DoH detection** - Alert on encrypted DNS connections
- **Suspicious TLD alerting** - Flag known malicious TLDs
- **Session logging** - CSV export with timestamps and alerts

## Requirements

- Windows 10/11
- [Npcap](https://npcap.com/) - Packet capture driver
- [w64devkit](https://github.com/skeeto/w64devkit) - GCC for Windows (to build)
- [Npcap SDK](https://npcap.com/#download) - Development headers

## Build

```bash
build.bat
```

## Usage

**Must run as Administrator** (required for packet capture).

```bash
# Interactive - lists interfaces and prompts for selection
dns_spy.exe

# Direct - specify interface number
dns_spy.exe %*
```

Press `Ctrl+C` to stop and view session statistics.

## Output

Real-time console output with color-coded alerts:
- White: Normal queries
- Yellow: Suspicious TLD
- Red: DGA/Exfiltration/Tunneling detected

CSV logs are saved automatically with timestamps.

## Alert Types

| Flag | Description |
|------|-------------|
| `[DGA?]` | Possible domain generation algorithm |
| `[EXFIL?]` | Possible data exfiltration |
| `[TUNNEL?]` | Possible DNS tunneling |
| `[SUS-TLD]` | Suspicious top-level domain |
| `[DoH]` | Encrypted DNS connection |

## License

For authorized security testing and educational use only.
